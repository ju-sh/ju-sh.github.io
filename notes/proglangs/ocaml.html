<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>OCaml</title>
  <style>
    body {
      max-width: 38rem;
      padding: 2rem;
      margin: auto;
      background-color: #FAF0E6;
    }
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
  </style>

</head>
<body>


<div id="header">
<a href="https://ju-sh.github.io">Home</a>
 | 
<a href="https://ju-sh.github.io/blog/index.html">Blog</a>
 | 
<a href="https://ju-sh.github.io/wiki/index.html">Wiki</a>
 | 
<a href="https://ju-sh.github.io/about.html">About</a>
</div>

<header id="title-block-header">
<h1 class="title">OCaml</h1>
</header>

<ul>
    </ul>




<hr/>

<div id="content-container">
<h2 id="general">General</h2>
<ul>
<li><p>Character constants: <code>'a'</code></p></li>
<li><p>List concatenation: <code>l1 @ l2</code></p></li>
<li><p>String concatenation: <code>str1 ^ str2</code> or <code>String.cat str1 str2</code></p></li>
<li><p>Format string concatenation: <code>str1 ^^ str2</code></p>
<ul>
<li><a href="https://www.brendanlong.com/ocaml-operator-cheatsheet.html">https://www.brendanlong.com/ocaml-operator-cheatsheet.html</a></li>
</ul></li>
<li><p>Anonymous function: <code>fun x y -&gt; x + y</code></p></li>
<li><p><code>@@</code>: comparable to <code>$</code> in haskell. First evaluates RHS then applies LHS to it. <a href="https://stackoverflow.com/questions/33394656/is-there-an-ocaml-operator-and-what-does-it-mean">ʳ</a></p></li>
<li><p>'~Module.(e)~ is equivalent to <code>let open Module in e</code>' <a href="https://stackoverflow.com/questions/30493644/ocaml-operator">ʳ</a></p>
<ul>
<li>Open a module temporarily for an expression.</li>
</ul></li>
<li><p>Check installed modules: <code>ocamlfind list</code></p></li>
<li><p>Anonymous function: <code>fun x -&gt; 3</code></p></li>
<li><p>difference between = and ==:</p>
<ul>
<li><code>==</code>: physical equality</li>
<li><code>=</code>: structural equality</li>
<li><a href="https://www2.lib.uchicago.edu/keith/ocaml-class/operators.html">https://www2.lib.uchicago.edu/keith/ocaml-class/operators.html</a></li>
</ul></li>
<li><p>Integer division: <code>/</code></p></li>
<li><p>Float division: <code>/.</code></p></li>
<li><p><code>else if</code>, not <code>elseif</code></p></li>
</ul>
<ul>
<li><p>Function arguments are eagerly evaluated.</p></li>
<li><p>Variables are made with <code>let</code>.</p></li>
<li><p>Recursive functions are made with <code>let rec</code>.</p></li>
<li><p><code>ocamlfmt</code>: an automatic code reformatter for ocaml</p></li>
<li><p><code>.mli</code> files: types for definitions in corresponding .ml file</p></li>
<li><p><code>.cmi</code> files: compiled form of .mli used during compilation?</p></li>
<li><p>Useful: <a href="https://doc.sherlocode.com/">https://doc.sherlocode.com/</a></p>
<ul>
<li>Like hoogle (haskell)</li>
</ul></li>
<li><p>More built-in modules:</p>
<ul>
<li>Like Array, but length can vary over time: <a href="https://ocaml.org/manual/5.2/api/Dynarray.html">https://ocaml.org/manual/5.2/api/Dynarray.html</a></li>
</ul></li>
</ul>
<h2 id="partial-application-of-function">Partial application of function</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a># (=) <span class="dv">3</span> <span class="dv">2</span>;;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>- : <span class="dt">bool</span> = <span class="kw">false</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a># (=) <span class="dv">3</span> <span class="dv">3</span>;;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>- : <span class="dt">bool</span> = <span class="kw">true</span></span></code></pre></div>
<h2 id="list">List</h2>
<ul>
<li><code>mem x l</code>: x ∈­l</li>
</ul>
<p><a href="https://ocaml.org/manual/5.2/api/List.html">https://ocaml.org/manual/5.2/api/List.html</a></p>
<h2 id="flip-function-fun.flip">Flip function: <code>Fun.flip</code></h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a># Fun.flip;;</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>- : (&#39;a -&gt; &#39;b -&gt; &#39;c) -&gt; &#39;b -&gt; &#39;a -&gt; &#39;c = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a># <span class="dt">List</span>.mem;;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>- : &#39;a -&gt; &#39;a <span class="dt">list</span> -&gt; <span class="dt">bool</span> = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a># Fun.flip <span class="dt">List</span>.mem;;</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>- : &#39;_weak1 <span class="dt">list</span> -&gt; &#39;_weak1 -&gt; <span class="dt">bool</span> = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a># Fun.flip <span class="dt">List</span>.mem [<span class="dv">2</span>;<span class="dv">3</span>];;</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>- : <span class="dt">int</span> -&gt; <span class="dt">bool</span> = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a># Fun.flip <span class="dt">List</span>.mem [<span class="dv">2</span>;<span class="dv">3</span>] <span class="dv">4</span>;;</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>- : <span class="dt">bool</span> = <span class="kw">false</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a># Fun.flip <span class="dt">List</span>.mem [<span class="dv">2</span>;<span class="dv">3</span>] <span class="dv">3</span>;;</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>- : <span class="dt">bool</span> = <span class="kw">true</span></span></code></pre></div>
<h2 id="optional-arguments">Optional arguments</h2>
<p>Like Labeled arguments, but with a default value and <code>?</code> instead of a tilde.</p>
<pre><code>&gt;&gt;&gt; let foo ?(a=3) b = a + b;;
val foo : ?a:int -&gt; int -&gt; int = &lt;fun&gt;

&gt;&gt;&gt; foo 2;;
- : int = 5

(* Overriding default value *)
&gt;&gt;&gt; foo ~a:10 2;;
- : int = 12

(* Yeah, order doesn&#39;t matter *)
&gt;&gt;&gt; foo 2 ~a:10;;
- : int = 12

&gt;&gt;&gt; foo ~a:10;;
- : int -&gt; int = &lt;fun&gt;
</code></pre>
<p>Reference: <a href="https://v2.ocaml.org/manual/lablexamples.html#s:optional-arguments">https://v2.ocaml.org/manual/lablexamples.html#s:optional-arguments</a></p>
<h2 id="operator"><code>(|&gt;)</code> operator</h2>
<p>It's like a reversed apply. <a href="https://stackoverflow.com/questions/30493644/ocaml-operator">ʳ</a></p>
<p>Function can be made to appear on RHS and its argument in LHS.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>(|&gt;);;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>- : &#39;a -&gt; (&#39;a -&gt; &#39;b) -&gt; &#39;b = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="fl">0.0</span> |&gt; <span class="dt">sin</span>;;</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>- : <span class="dt">float</span> = <span class="dv">0</span>.</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="dt">sin</span> <span class="fl">0.0</span>;;</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>- : <span class="dt">float</span> = <span class="dv">0</span>.</span></code></pre></div>
<p>Useful to make a 'pipeline' where the value flows from the left to the right. As in:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">let</span> simple_process s =</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>  Str.split Owl_nlp_utils.regexp_split s</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  |&gt; <span class="dt">List</span>.filter (<span class="kw">fun</span> x -&gt; <span class="dt">String</span>.length x &gt; <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>  |&gt; <span class="dt">String</span>.concat <span class="st">&quot; &quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>  |&gt; <span class="dt">String</span>.lowercase_ascii</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>  |&gt; <span class="dt">Bytes</span>.of_string</span></code></pre></div>
<p>(forgot from where I got this snippet..)</p>
<h2 id="empty-type">Empty type</h2>
<p>We can make 'empty types'. ie, types without even a single constructor. <a href="https://cs3110.github.io/textbook/chapters/adv/curry-howard.html">¹</a></p>
<p>Like:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">type</span> empty = |</span></code></pre></div>
<p>Lack of constructors means it's impossible to construct a value of type <code>empty</code>.</p>
<h2 id="explicit-subtyping-info-in-type-variables">Explicit subtyping info in type variables</h2>
<p>Via <strong>variance annotations</strong>.</p>
<ul>
<li>Covariant: <code>+'a</code></li>
<li>Contravariant: <code>-'a</code></li>
</ul>
<p>By default, type variables are covariant.</p>
<p>ocaml infers them, but the explicit notation can be helpful in the 'interface' of modules (ocaml analogue of structures).</p>
<p>References:</p>
<ul>
<li><a href="https://blog.janestreet.com/a-and-a/">https://blog.janestreet.com/a-and-a/</a></li>
</ul>
<h2 id="reference-variables">Reference (variables)</h2>
<p>Mutable values.</p>
<pre><code># incr;;
- : int ref -&gt; unit = &lt;fun&gt;

# let r = ref 0;;
val r : int ref = {contents = 0}

# !r;;
- : int = 0

# incr r;;
- : unit = ()

# !r;;
- : int = 1
</code></pre>
<h2 id="record-types">Record types</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">type</span> person = {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>    name: <span class="dt">string</span>;</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    age: <span class="dt">int</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>}</span></code></pre></div>
<h2 id="mutable-keyword-in-ocaml"><code>mutable</code> keyword in ocaml</h2>
<p>Modifiable values. ie, non-pure.</p>
<p><code>mutable</code> is not part of the type. Just property of the variable.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">type</span> point = {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>    x: <span class="dt">int</span>;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>    <span class="kw">mutable</span> y: <span class="dt">int</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a># <span class="kw">let</span> p = {x=<span class="dv">3</span>; y=<span class="dv">4</span>};;</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="kw">val</span> p : point = {x = <span class="dv">3</span>; y = <span class="dv">4</span>}</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a># p.x &lt;- <span class="dv">10</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>Error: The record field x is <span class="dt">not</span> <span class="kw">mutable</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a># p.y &lt;- <span class="dv">10</span>;;</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>- : <span class="dt">unit</span> = ()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a># p</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>- : point = {x = <span class="dv">3</span>; y = <span class="dv">10</span>}</span></code></pre></div>
<p>References:</p>
<ul>
<li><a href="https://caml.inria.fr/pub/docs/fpcl/fpcl-07.pdf">https://caml.inria.fr/pub/docs/fpcl/fpcl-07.pdf</a></li>
<li><a href="https://www.cs.cornell.edu/courses/cs3110/2018sp/l/14-mutable/notes.html">https://www.cs.cornell.edu/courses/cs3110/2018sp/l/14-mutable/notes.html</a></li>
<li><a href="https://cs3110.github.io/textbook/chapters/mut/mutable_fields.html">https://cs3110.github.io/textbook/chapters/mut/mutable_fields.html</a></li>
</ul>
<h2 id="tilde-in-arguments">Tilde in arguments</h2>
<p>They are <strong>labelled arguments</strong>.</p>
<p><a href="https://ocaml.org/docs/labels">https://ocaml.org/docs/labels</a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">let</span> <span class="kw">rec</span> range ~first:a ~last:b =</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>  <span class="kw">if</span> a &gt; b <span class="kw">then</span> []</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>  <span class="kw">else</span> a :: range ~first:(a+<span class="dv">1</span>) ~last:b</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a># range</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>- : first:<span class="dt">int</span> -&gt; last:<span class="dt">int</span> -&gt; <span class="dt">int</span> <span class="dt">list</span> = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co">(* Show the argument labels! *)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a># range <span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>- : <span class="dt">int</span> <span class="dt">list</span> = [<span class="dv">3</span>; <span class="dv">4</span>; <span class="dv">5</span>]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a><span class="co">(* Now argument order can be changed *)</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a># range ~last:<span class="dv">10</span> ~first:<span class="dv">3</span>;;</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>- : <span class="dt">int</span> <span class="dt">list</span> = [<span class="dv">3</span>; <span class="dv">4</span>; <span class="dv">5</span>; <span class="dv">6</span>; <span class="dv">7</span>; <span class="dv">8</span>; <span class="dv">9</span>; <span class="dv">10</span>]</span></code></pre></div>
<h2 id="multi-line-strings">Multi-line strings</h2>
<p>Use within <code>{|</code> and <code>|}</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a># {| hello</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>   world</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>   |};;</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>- : <span class="dt">string</span> = <span class="st">&quot; hello</span><span class="ch">\n</span><span class="st">   world</span><span class="ch">\n</span><span class="st">   &quot;</span></span></code></pre></div>
<h2 id="pattern-matching">pattern matching</h2>
<p>See: <a href="https://v2.ocaml.org/manual/patterns.html">https://v2.ocaml.org/manual/patterns.html</a></p>
<p>Can use <code>function</code> to pattern match without actually naming variables:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co">(* Given two lists, check if their concatenation is nil *)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">let</span> is2Nil = <span class="kw">function</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>  | [], [] -&gt; <span class="kw">true</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>  | _, _ -&gt; <span class="kw">false</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="co">(* is2Nil : &#39;a list * &#39;b list -&gt; bool *)</span></span></code></pre></div>
<p>Or can use <code>match</code> as in Coq:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">let</span> is2Nil a b = </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>  <span class="kw">match</span> a, b <span class="kw">with</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>  | [], [] -&gt; <span class="kw">true</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>  | _, _ -&gt; <span class="kw">false</span></span></code></pre></div>
<h2 id="array">Array</h2>
<ul>
<li>Array is mutable.</li>
</ul>
<p><a href="https://ocaml.org/manual/5.2/api/Array.html">https://ocaml.org/manual/5.2/api/Array.html</a></p>
<ul>
<li>Indexing
<ul>
<li>1-D array: <code>arr.(i)</code> / <code>get arr i</code></li>
<li>2-D array: <code>arr.(i).(j)</code></li>
</ul></li>
<li>Writing: <code>arr.(i) &lt;- new_val</code>
<ul>
<li>Or <code>set arr i new_val</code></li>
</ul></li>
<li>Length: <code>length arr</code></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a># <span class="kw">let</span> a = [|<span class="dv">1</span>; <span class="dv">2</span>; <span class="dv">3</span>; <span class="dv">4</span>|];;</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="kw">val</span> a : <span class="dt">int</span> <span class="dt">array</span> = [|<span class="dv">1</span>; <span class="dv">2</span>; <span class="dv">3</span>; <span class="dv">4</span>|]</span></code></pre></div>
<h2 id="sml-vs-ocaml">sml vs ocaml</h2>
<p>Analogues:</p>
<table>
<thead>
<tr class="header">
<th>sml</th>
<th>ocaml</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>structure</td>
<td>module</td>
<td></td>
</tr>
<tr class="even">
<td>signature</td>
<td>module type</td>
<td></td>
</tr>
<tr class="odd">
<td>fn</td>
<td>fun</td>
<td>Anonymous functions</td>
</tr>
<tr class="even">
<td>f o g</td>
<td>-NA-</td>
<td>Function composition</td>
</tr>
<tr class="odd">
<td>case</td>
<td>match</td>
<td>Pattern matching</td>
</tr>
</tbody>
</table>
<p>Apparently, ocaml doesn't have a built-in <code>compose</code> function.</p>
<p>—</p>
<p>List elements are separated with <code>;</code> in ocaml and <code>,</code> in sml</p>
<p>sml:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode sml"><code class="sourceCode sml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>Standard ML <span class="kw">of</span> New Jersey (<span class="dv">64</span>-bit) v110<span class="fl">.95</span> [built: Sat Feb <span class="dv">05</span> <span class="dv">19</span>:<span class="dv">22</span>:<span class="dv">43</span> <span class="dv">2022</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>];;</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="kw">val</span> it = [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>] : <span class="dt">int</span> <span class="dt">list</span></span></code></pre></div>
<p>OCaml:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a>OCaml version <span class="fl">4.14</span>.<span class="dv">1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>Enter #help;; <span class="kw">for</span> help.</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>];;</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>- : (<span class="dt">int</span> * <span class="dt">int</span> * <span class="dt">int</span>) <span class="dt">list</span> = [(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>[<span class="dv">1</span>;<span class="dv">2</span>;<span class="dv">3</span>];;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>- : <span class="dt">int</span> <span class="dt">list</span> = [<span class="dv">1</span>; <span class="dv">2</span>; <span class="dv">3</span>]</span></code></pre></div>
<p>See: <a href="http://adam.chlipala.net/mlcomp/">http://adam.chlipala.net/mlcomp/</a></p>
<h2 id="imperative-features">Imperative features</h2>
<p>From <a href="https://ocaml.org/docs/objects">https://ocaml.org/docs/objects</a>:</p>
<blockquote>
<p>OCaml is an object-oriented, imperative, functional programming language. It mixes all these paradigms and lets you use the most appropriate (or most familiar) programming paradigm for the task at hand.</p>
</blockquote>
<p>(Haskell is 'purer' than OCaml in the sense that there is lesser chance of side-effects.)</p>
<h3 id="oop-object-oriented-programming">OOP (Object-oriented programming)</h3>
<p>ocaml supports OOP-style classes: <a href="https://ocaml.org/docs/objects">https://ocaml.org/docs/objects</a></p>
<ul>
<li>Access method <code>foo</code> of an object <code>obj</code> with <code>obj#foo</code></li>
<li><code>new</code> keyword is used to make a new object of a class
<ul>
<li>Eg: <code>new LTerm_widget.hbox</code></li>
</ul></li>
</ul>
<h3 id="loops">Loops</h3>
<p><a href="https://ocaml.org/docs/if-statements-and-loops">https://ocaml.org/docs/if-statements-and-loops</a></p>
<ul>
<li>Both <code>for</code> and <code>while</code> loops available.</li>
<li>Can't break out of loop early: No <code>break</code>, <code>continue</code></li>
</ul>
<h2 id="doubts">Doubts</h2>
<ul>
<li>Use of <code>.mli</code> files</li>
<li>Camlp4 and Camlp5: for writing (complex?) parsers</li>
</ul>
<h2 id="infix-operator-as-prefix">Infix operator as prefix</h2>
<p>Enclose the operator within parenthesis.</p>
<p>Example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>utop # <span class="dt">List</span>.map (<span class="kw">fun</span> s -&gt; <span class="st">&quot;prefix &quot;</span> ^ s) l;;</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>- : <span class="dt">string</span> <span class="dt">list</span> = [<span class="st">&quot;prefix hi&quot;</span>; <span class="st">&quot;prefix hello&quot;</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>utop # <span class="dt">List</span>.map ((^) <span class="st">&quot;prefix &quot;</span>) l;;</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>- : <span class="dt">string</span> <span class="dt">list</span> = [<span class="st">&quot;prefix hi&quot;</span>; <span class="st">&quot;prefix hello&quot;</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>utop # <span class="dt">List</span>.map (<span class="dt">String</span>.cat <span class="st">&quot;prefix &quot;</span>) l;;</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>- : <span class="dt">string</span> <span class="dt">list</span> = [<span class="st">&quot;prefix hi&quot;</span>; <span class="st">&quot;prefix hello&quot;</span>]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>utop # (^) ;;</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>- : <span class="dt">string</span> -&gt; <span class="dt">string</span> -&gt; <span class="dt">string</span> = &lt;<span class="kw">fun</span>&gt;</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a>utop # (^) <span class="st">&quot;a&quot;</span>;;</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>- : <span class="dt">string</span> -&gt; <span class="dt">string</span> = &lt;<span class="kw">fun</span>&gt;</span></code></pre></div>
<h2 id="making-an-infix-operatorfunction">Making an infix operator/function</h2>
<p>Just put the name consisting of special characters and enclose it within parenthesis, I guess. <a href="https://stackoverflow.com/questions/38147841/how-to-define-an-infix-not-symbolic-aka-not-an-operator-function-in-ocaml">https://stackoverflow.com/questions/38147841/how-to-define-an-infix-not-symbolic-aka-not-an-operator-function-in-ocaml</a></p>
<pre><code>utop # let (+-) x y = x + y;;
val ( +- ) : int -&gt; int -&gt; int = &lt;fun&gt;

utop # 3 +- 4;;
- : int = 7

utop # let (a) x y = x + y;;
Error: Syntax error
</code></pre>
<h2 id="if-without-else"><code>if</code> without <code>else</code></h2>
<p>This is possible if the <code>then</code> part value is of type <code>unit</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="kw">fun</span> x -&gt; <span class="kw">if</span> x&lt;<span class="dv">3</span> <span class="kw">then</span> () ;;</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>- : <span class="dt">int</span> -&gt; <span class="dt">unit</span> = &lt;<span class="kw">fun</span>&gt;</span></code></pre></div>
<p>Otherwise, it would give error:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a># <span class="kw">fun</span> x -&gt; <span class="kw">if</span> x&lt;<span class="dv">3</span> <span class="kw">then</span> <span class="st">&quot;hi&quot;</span> ;;</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>Error: This expression has <span class="kw">type</span> <span class="dt">string</span> but an expression was expected <span class="kw">of</span> <span class="kw">type</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>         <span class="dt">unit</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>       because it is <span class="kw">in</span> the result <span class="kw">of</span> a conditional <span class="kw">with</span> no <span class="kw">else</span> branch</span></code></pre></div>
<p>Links:</p>
<ul>
<li><a href="https://v2.ocaml.org/manual/expr.html#sss:expr-conditional">https://v2.ocaml.org/manual/expr.html#sss:expr-conditional</a></li>
<li><a href="https://stackoverflow.com/questions/19338709/ocaml-is-it-possible-to-creat-single-if-without-else">https://stackoverflow.com/questions/19338709/ocaml-is-it-possible-to-creat-single-if-without-else</a></li>
</ul>
<h2 id="function-vs-value">Function vs value</h2>
<p>This is a function:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">let</span> gethm () =</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>  <span class="kw">let</span> now = Unix.localtime (Unix.time ()) <span class="kw">in</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>  <span class="kw">let</span> hour = now.tm_hour <span class="kw">in</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>  <span class="kw">let</span> minute = now.tm_min <span class="kw">in</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>  (hour, minute)</span></code></pre></div>
<p>But this is a value:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="kw">let</span> gethm =</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>  <span class="kw">let</span> now = Unix.localtime (Unix.time ()) <span class="kw">in</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>  <span class="kw">let</span> hour = now.tm_hour <span class="kw">in</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>  <span class="kw">let</span> minute = now.tm_min <span class="kw">in</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>  (hour, minute)</span></code></pre></div>
<h2 id="some-errors">Some errors</h2>
<h3 id="load"><code>#load</code></h3>
<p>Error: Reference to undefined global `Unix' Hint: This means that the interface of a module is loaded, but its implementation is not. Found <em>home/famubu</em>.opam/5.1.0/lib/ocaml/unix/unix.cma in the load paths. Did you mean to load it using #load "unix.cma" or by passing it as an argument to the toplevel?</p>
<p>let now = Unix.localtime (Unix.time ()) in let hour = now.tm<sub>hour</sub> in let minute = now.tm<sub>min</sub> in (hour, minute);;</p>
<p>val gethm : int * int = (11, 25)</p>
<p>#+end<sub>src</sub></p>
<h3 id="lack-of-information-on-exception">Lack of information on exception</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>$ <span class="ex">dune</span> exec clock</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="ex">2024-08-19</span> 09:08:43.72231Z ERROR [thread=3] Process <span class="op">&lt;</span>0.5.<span class="op">0&gt;</span> died with unhandled exception Invalid_argument(<span class="st">&quot;index out of bounds&quot;</span>)<span class="bu">:</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>$ <span class="va">OCAMLRUNPARAM=</span>b</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>$ <span class="ex">dune</span> exec clock</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="ex">2024-08-19</span> 09:09:35.34246Z ERROR [thread=0] Process <span class="op">&lt;</span>0.6.<span class="op">0&gt;</span> died with unhandled exception Invalid_argument(<span class="st">&quot;index out of bounds&quot;</span>)<span class="bu">:</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a><span class="ex">Raised</span> by primitive operation at Clock__Model.build_outstr in file <span class="st">&quot;lib/model.ml&quot;</span>, line 112, characters 8-24</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a><span class="ex">Called</span> from Minttea__Program.init in file <span class="st">&quot;minttea/program.ml&quot;</span>, line 49, characters 13-35</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a><span class="ex">Called</span> from Runtime__Import._spawn.(fun) <span class="kw">in</span> <span class="fu">file</span> <span class="st">&quot;riot/runtime/import.ml&quot;</span>, line 92, characters 10-15</span></code></pre></div>
<p>Another example:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>$ <span class="bu">export</span> <span class="va">OCAMLRUNPARAM=</span>b</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>$ <span class="ex">dune</span> exec clock</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="ex">2024-08-19</span> 09:11:36.12397Z ERROR [thread=2] Process <span class="op">&lt;</span>0.6.<span class="op">0&gt;</span> died with unhandled exception Invalid_argument(<span class="st">&quot;index out of bounds&quot;</span>)<span class="bu">:</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a><span class="ex">Raised</span> by primitive operation at Clock__Model.build_outstr in file <span class="st">&quot;lib/model.ml&quot;</span>, line 79, characters 8-22</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="ex">Called</span> from Minttea__Program.init in file <span class="st">&quot;minttea/program.ml&quot;</span>, line 49, characters 13-35</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a><span class="ex">Called</span> from Runtime__Import._spawn.(fun) <span class="kw">in</span> <span class="fu">file</span> <span class="st">&quot;riot/runtime/import.ml&quot;</span>, line 92, characters 10-15</span></code></pre></div>
</div>
</body>
</html>
